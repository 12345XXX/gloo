---
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  labels:
    gloo: event-emitter
  name: event-emitter
  namespace: {{.Namespace}}
spec:
  selector:
    matchLabels:
      gloo: event-emitter
  replicas: 1
  template:
    metadata:
      labels:
        gloo: event-emitter
    spec:
      containers:
      - image: soloio/event-emitter:testing
        imagePullPolicy: Always
        name: event-emitter
        ports:
        - containerPort: 8080
          name: http
---
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  labels:
    gloo: upstream-for-events
  name: upstream-for-events
  namespace: {{.Namespace}}
spec:
  selector:
    matchLabels:
      gloo: upstream-for-events
  replicas: 1
  template:
    metadata:
      labels:
        gloo: upstream-for-events
    spec:
      containers:
      - image: soloio/upstream-for-events:testing
        imagePullPolicy: Always
        name: upstream-for-events
        ports:
        - containerPort: 8080
          name: http
---
apiVersion: v1
kind: Service
metadata:
  name: upstream-for-events
  labels:
    sevice: upstream-for-events
  namespace: {{.Namespace}}
spec:
  ports:
  - port: 8080
    protocol: TCP
  selector:
    gloo: upstream-for-events
---
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  labels:
    gloo: helloservice-2
  name: helloservice-2
  namespace: {{.Namespace}}
spec:
  selector:
    matchLabels:
      gloo: helloservice-2
  replicas: 1
  template:
    metadata:
      labels:
        gloo: helloservice-2
    spec:
      containers:
      - image: soloio/helloservice:testing
        imagePullPolicy: Always
        name: helloservice-2
        args:
        - "--reply=expected-reply-2"
        ports:
        - containerPort: 8080
          name: http
---
apiVersion: v1
kind: Service
metadata:
  name: helloservice-2
  labels:
    sevice: helloservice-2
  namespace: {{.Namespace}}
spec:
  ports:
  - port: 8080
    protocol: TCP
  selector:
    gloo: helloservice-2
---
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  labels:
    gloo: helloservice
  name: helloservice
  namespace: {{.Namespace}}
spec:
  selector:
    matchLabels:
      gloo: helloservice
  replicas: 1
  template:
    metadata:
      labels:
        gloo: helloservice
    spec:
      containers:
      - image: soloio/helloservice:testing
        imagePullPolicy: Always
        name: helloservice
        args:
        - "--reply=expected-reply-1"
        ports:
        - containerPort: 8080
          name: http
---
apiVersion: v1
kind: Service
metadata:
  name: helloservice
  labels:
    sevice: helloservice
  namespace: {{.Namespace}}
spec:
  ports:
  - port: 8080
    protocol: TCP
  selector:
    gloo: helloservice
---
apiVersion: v1
kind: Pod
metadata:
  labels:
    gloo: testrunner
  name: testrunner
  namespace: {{.Namespace}}
spec:
  containers:
  - image: soloio/testrunner:testing
    command:
      - sleep
      - "36000"
    name: testrunner
  restartPolicy: Always